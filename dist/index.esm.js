import t,{useRef as n,useEffect as e}from"react";import*as r from"d3";var a="treeDiagram-module__container___ul7sf",i="treeDiagram-module__nodeBox___bMi2f",c="treeDiagram-module__hasChildren___NYfIy",o="treeDiagram-module__zoomButtons___IEn09",l="treeDiagram-module__zoomButton___7ssUE",d=function(d){var u=d.data,s=d.initialOpenDepth,f=void 0===s?1:s,m=n(null),p=n(null),h=n(null),v="undefined"!=typeof window&&window.VITEST;e(function(){if(u){var t=m.current.parentElement.clientWidth,n=400,e=100,a=t-e-200,o=800-n-40,l=750,d=0,s=r.hierarchy(u);s.y0=o/3,s.x0=0,function t(n,e,r){if(!n.children)return;e>=r?(n._children=n.children,n._children.forEach(function(n){return t(n,e+1,r)}),n.children=null):n.children.forEach(function(n){return t(n,e+1,r)})}(s,0,f);var x=r.select(m.current).attr("viewBox","0 0 ".concat(t," ").concat(800)).attr("preserveAspectRatio","xMidYMid meet");x.selectAll("*").remove();var g=x.append("g");p.current=g;var y=r.zoom().scaleExtent([.5,2]).on("zoom",function(t){g.attr("transform",t.transform)});h.current=y,x.call(y);var _=r.zoomIdentity.translate(e+a,n).scale(.7);v||r.select(m.current).call(y.transform,_);var w=r.tree().nodeSize([120,-280]),E=r.linkHorizontal().x(function(t){return t.y}).y(function(t){return t.x});!function t(n){var e=w(s),r=e.descendants(),a=e.links(),o=g.selectAll("g.node").data(r,function(t){return t.id||(t.id=++d)}),u=o.enter().append("g").attr("class","node").attr("transform",function(t){return"translate(".concat(n.y0,",").concat(n.x0,")")}).on("click",function(n,e){e.children?(e._children=e.children,e.children=null,t(e),k(e)):(e.children=e._children,e._children=null,t(e),k(e))});u.append("foreignObject").attr("x",-190).attr("y",function(t){return t.data.stage?-35:-18.5}).attr("width",190).attr("height",120).append("xhtml:div").attr("class",function(t){return"".concat(i," ").concat(t._children||t.children?c:"")}).html(function(t){return'<div  style="display:flex"  >\n              \n            <div style="width:100%" >\n            '.concat(t.data.stage?'<div \n              style="background-color:white;border-radius:0px 6px 0px 0px;padding:5px" \n              >\n              '.concat(t.data.stage,"\n              </div>"):"<div></div>",'\n            <div \n            style="margin-top:').concat(t.data.stage?"5px":"0px",';padding:5px" \n            >\n            ').concat(t.data.name,"\n            </div>\n            </div>\n            ").concat(t.data.percent?'<div style="width:50%;background-color:white;display:flex;align-items:center;justify-content:center;border-radius:6px 0px 0px 6px;border-right:solid 1px var(--adl-yellow)" >'.concat(t.data.percent+"%","</div>"):"<div></div>","\n            </div>")}),u.merge(o).transition().duration(l).attr("transform",function(t){return"translate(".concat(t.y,",").concat(t.x,")")}),o.exit().transition().duration(l).attr("transform",function(t){return"translate(".concat(n.y,",").concat(n.x,")")}).remove();var f=g.selectAll("path.link").data(a,function(t){return t.target.id});f.enter().insert("path","g").attr("class","link").attr("fill","none").attr("stroke","black").attr("stroke-width","1px").attr("d",function(t){var e={x:n.x0,y:n.y0};return E({source:e,target:e})}).merge(f).transition().duration(l).attr("d",E),f.exit().transition().duration(l).attr("d",function(t){var e={x:n.x,y:n.y};return E({source:e,target:e})}).remove(),r.forEach(function(t){t.x0=t.x,t.y0=t.y})}(s)}function k(t){var n,e=window.innerWidth<768,a=e?1:1.2,i=m.current.getBoundingClientRect(),c=i.width,o=i.height,d=t.y,u=t.x,s=e?[c/.8-d*a,o/2-u*a]:[c/2-d*a,o/2-u*a];r.select(m.current).transition().duration(l).call(h.current.transform,(n=r.zoomIdentity).translate.apply(n,s).scale(a))}},[u,f]);return t.createElement("div",{style:{position:"relative"}},t.createElement("svg",{ref:m,className:a}),t.createElement("div",{className:o},t.createElement("button",{className:l,onClick:function(){h.current&&m.current&&r.select(m.current).transition().call(h.current.scaleBy,1.2)}},"+"),t.createElement("button",{className:l,onClick:function(){h.current&&m.current&&r.select(m.current).transition().call(h.current.scaleBy,.8)}},"âˆ’")))};export{d as TreeDiagram,d as default};
//# sourceMappingURL=index.esm.js.map
